select * from sucursal 



select * from cuenta 
-- Aplicaci√≥n de Tabla temporal

drop table EUREKA.RESUMEN if exists;

create global temporary table EUREKA.RESUMEN (
  --id number primary key,   
  suc_codigo varchar2(10) primary key,
  suc_nombre varchar2(200),
  saldo_soles number(12,2),
  saldo_dolares number(12,2)
) on commit preserve rows; 


CREATE SEQUENCE eureka.SQ_RESUMEN;



CREATE OR REPLACE PROCEDURE EUREKA.CREAR_RESUMEN
IS
  v_ssoles number;
  v_sdolares number;
BEGIN
  -- Limpiar tabla
  delete from EUREKA.RESUMEN;
  -- Carga inicial de datos
  insert into EUREKA.RESUMEN(id,suc_codigo, suc_nombre)
  select eureka.SQ_RESUMEN.nextval,chr_sucucodigo, vch_sucunombre 
  from EUREKA.sucursal;
  -- Calcular saldos
  for r in (select * from EUREKA.RESUMEN) loop
    
    select sum(dec_cuensaldo) into v_ssoles 
    from eureka.cuenta
    where chr_monecodigo = '01'
    and chr_sucucodigo = r.suc_codigo;
    
    select sum(dec_cuensaldo) into v_sdolares 
    from eureka.cuenta
    where chr_monecodigo = '02'
    and chr_sucucodigo = r.suc_codigo;
    
    update EUREKA.RESUMEN
    set saldo_soles = nvl(v_ssoles,0), 
        saldo_dolares = nvl(v_sdolares,0)
    where id = r.id;
    
  end loop;
  commit;
END;
/